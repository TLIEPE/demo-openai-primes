# Prime Numbers Calculation Script by TLIEPE


## Versioning

This project maintains two versions:
 
- **v1**: Uses OpenAI's beta feature for structured outputs (deprecated approach).
- **v2**: Updated to use the stable Instructor library integration with OpenAI API for structured outputs.

Version tags are available in the Git history for easy reference:
 
- `v1` - Original beta version
- `v2` - Updated Instructor version


## Overview
This script is a showcase of a new approach to generating **structured output** using OpenAI's beta capabilities for structured outputs in its API. The script demonstrates a comparison between prime numbers generated locally and those generated through the OpenAI API using structured outputs.

**Important Update:** As OpenAI's structured output feature is currently in beta and subject to future changes, this project has been updated to use the stable approach with the Instructor library. This prevents issues when the beta API is deprecated ("sundown"). The original beta version is preserved in the repository history.

The **structured output** capability of OpenAI helps ensure responses adhere to a defined format, validated using tools like Pydantic. In this case, it ensures a list of prime numbers is returned in a consistent manner.

## How It Works
The script calculates prime numbers in two different ways:

1. **OpenAI API (with structured output):** The script sends a request to OpenAI's API to provide all prime numbers up to a user-specified limit. The response is validated using a Pydantic model (`PrimeNumberResponse`) to ensure structured and predictable output.

2. **Local Calculation:** The script uses the SymPy library to compute the same prime numbers locally.

Both results are displayed side by side, allowing you to compare the numbers generated by the OpenAI API and the local computation.

## Code Flow
1. **API Key Setup:** The OpenAI API key is set using an environment variable named `OPENAI_API_KEY`. Make sure this variable is set correctly before running the script.
2. **User Input:** The user is prompted to provide an upper limit for calculating prime numbers.
3. **OpenAI API Request:** The script sends a structured request to OpenAI, asking it to generate the prime numbers up to the user-provided limit.
4. **Local Computation:** The script also calculates the prime numbers locally using SymPy's `primerange` function.
5. **Comparison Display:** Both sets of results are displayed side by side for easy comparison, indicating whether they match.

## Prerequisites
Before running the script, you'll need to set up a virtual environment and install the required libraries.

### Setting up a Virtual Environment on macOS
To set up a virtual environment, follow these steps:

1. **Open Terminal**
2. Navigate to your desired directory:
   ```sh
   cd /path/to/your/project
   ```
3. Create a virtual environment named `macenv`:
   ```sh
   python3 -m venv macenv
   ```
4. Activate the virtual environment:
   ```sh
   source macenv/bin/activate
   ```
5. Install the required libraries using the `requirements.txt` file:
   ```sh
   pip install -r requirements.txt
   ```
6. Or install the required libraries manuel:
   ```sh
   pip install openai instructor pydantic sympy
   ```

After setting up the virtual environment and installing the libraries, you're ready to run the script.

## Running the Script
1. Make sure the virtual environment is activated (`source macenv/bin/activate`).
2. Set the OpenAI API key as an environment variable:
   ```sh
   export OPENAI_API_KEY=your_openai_api_key_here
   ```
3. Run the script:
   ```sh
   python3 main.py
   ```

## Notes
- **Structured Output Handling**: Initially, this project used OpenAI's beta feature for structured outputs. It now uses the Instructor library for a stable, production-ready approach. For details about the original beta feature, see [Structured Outputs Introduction](https://openai.com/index/introducing-structured-outputs-in-the-api/).
- **MIT License**: This project is licensed under the MIT License, meaning you are free to use, modify, and distribute it as long as proper credit is given.

- **Strict Mode Option**: OpenAI now supports a strict mode in structured output, ensuring perfect schema compliance. This project currently uses a relaxed mode for flexibility in examples. For critical applications, enabling `strict: true` is recommended to guarantee response schema adherence.

## License
MIT License. See `LICENSE` for more details.

## Contributing
Feel free to open issues or submit pull requests if you'd like to contribute or have ideas for improving this project.
